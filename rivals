local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Camera = Workspace.CurrentCamera

local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

-- Settings
local Settings = {
    -- ESP Settings
    ESP = {
        Enabled = false,
        ShowNames = true,
        ShowDistance = true,
        ShowHealth = true,
        ShowBoxes = true,
        TeamCheck = true,
        BoxColor = Color3.fromRGB(255, 255, 255),
        NameColor = Color3.fromRGB(255, 255, 255)
    },
    
    -- Aimbot Settings
    Aimbot = {
        Enabled = false,
        TeamCheck = true,
        VisibleCheck = true,
        FOV = 150,
        ShowFOV = true,
        FOVColor = Color3.fromRGB(255, 255, 255),
        Smoothness = 5,
        AimPart = "Head"
    },
    
    -- Silent Aim Settings
    SilentAim = {
        Enabled = false,
        TeamCheck = true,
        FOV = 100,
        HitChance = 100,
        AimPart = "Head"
    },
    
    -- Movement Settings
    Movement = {
        Speed = 16,
        JumpPower = 50,
        SpeedEnabled = false,
        JumpEnabled = false,
        NoClip = false,
        InfiniteJump = false
    },
    
    -- Combat Settings
    Combat = {
        AutoParry = false,
        NoRecoil = false,
        InfiniteAmmo = false,
        RapidFire = false,
        AutoShoot = false,
        TriggerBot = false
    },
    
    -- Visual Settings
    Visual = {
        RemoveFog = false,
        Fullbright = false,
        CrosshairEnabled = false,
        CrosshairSize = 10,
        CrosshairColor = Color3.fromRGB(0, 255, 0)
    }
}

-- ESP Storage
local ESPObjects = {}

-- Create GUI
local Window = Rayfield:CreateWindow({
    Name = "lunar x",
    LoadingTitle = "fuck you",
    LoadingSubtitle = "by _n.ick",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "rivals",
        FileName = "gay"
    },
    Discord = {
        Enabled = false
    },
    KeySystem = false
})

-- Combat Tab
local CombatTab = Window:CreateTab("Combat", 4483362458)

local AimbotSection = CombatTab:CreateSection("Aimbot")

local AimbotToggle = CombatTab:CreateToggle({
    Name = "Enable Aimbot",
    CurrentValue = false,
    Flag = "AimbotToggle",
    Callback = function(Value)
        Settings.Aimbot.Enabled = Value
    end,
})

local AimbotTeamCheck = CombatTab:CreateToggle({
    Name = "Team Check",
    CurrentValue = true,
    Flag = "AimbotTeamCheck",
    Callback = function(Value)
        Settings.Aimbot.TeamCheck = Value
    end,
})

local AimbotFOV = CombatTab:CreateSlider({
    Name = "Aimbot FOV",
    Range = {0, 500},
    Increment = 10,
    CurrentValue = 150,
    Flag = "AimbotFOV",
    Callback = function(Value)
        Settings.Aimbot.FOV = Value
    end,
})

local AimbotSmoothness = CombatTab:CreateSlider({
    Name = "Smoothness",
    Range = {1, 20},
    Increment = 1,
    CurrentValue = 5,
    Flag = "AimbotSmoothness",
    Callback = function(Value)
        Settings.Aimbot.Smoothness = Value
    end,
})

local ShowFOV = CombatTab:CreateToggle({
    Name = "Show FOV Circle",
    CurrentValue = true,
    Flag = "ShowFOV",
    Callback = function(Value)
        Settings.Aimbot.ShowFOV = Value
    end,
})

local SilentAimSection = CombatTab:CreateSection("Silent Aim")

local SilentAimToggle = CombatTab:CreateToggle({
    Name = "Enable Silent Aim",
    CurrentValue = false,
    Flag = "SilentAimToggle",
    Callback = function(Value)
        Settings.SilentAim.Enabled = Value
    end,
})

local SilentAimFOV = CombatTab:CreateSlider({
    Name = "Silent Aim FOV",
    Range = {0, 300},
    Increment = 10,
    CurrentValue = 100,
    Flag = "SilentAimFOV",
    Callback = function(Value)
        Settings.SilentAim.FOV = Value
    end,
})

local CombatSection = CombatTab:CreateSection("Combat Features")

local AutoParry = CombatTab:CreateToggle({
    Name = "Auto Parry",
    CurrentValue = false,
    Flag = "AutoParry",
    Callback = function(Value)
        Settings.Combat.AutoParry = Value
    end,
})

local NoRecoil = CombatTab:CreateToggle({
    Name = "No Recoil",
    CurrentValue = false,
    Flag = "NoRecoil",
    Callback = function(Value)
        Settings.Combat.NoRecoil = Value
    end,
})

local InfiniteAmmo = CombatTab:CreateToggle({
    Name = "Infinite Ammo",
    CurrentValue = false,
    Flag = "InfiniteAmmo",
    Callback = function(Value)
        Settings.Combat.InfiniteAmmo = Value
    end,
})

local RapidFire = CombatTab:CreateToggle({
    Name = "Rapid Fire",
    CurrentValue = false,
    Flag = "RapidFire",
    Callback = function(Value)
        Settings.Combat.RapidFire = Value
    end,
})

local TriggerBot = CombatTab:CreateToggle({
    Name = "Trigger Bot",
    CurrentValue = false,
    Flag = "TriggerBot",
    Callback = function(Value)
        Settings.Combat.TriggerBot = Value
    end,
})

-- Visuals Tab
local VisualsTab = Window:CreateTab("Visuals", 4483362458)

local ESPSection = VisualsTab:CreateSection("ESP")

local ESPToggle = VisualsTab:CreateToggle({
    Name = "Enable ESP",
    CurrentValue = false,
    Flag = "ESPToggle",
    Callback = function(Value)
        Settings.ESP.Enabled = Value
        if not Value then
            for _, esp in pairs(ESPObjects) do
                for _, obj in pairs(esp) do
                    obj:Remove()
                end
            end
            ESPObjects = {}
        end
    end,
})

local ShowNames = VisualsTab:CreateToggle({
    Name = "Show Names",
    CurrentValue = true,
    Flag = "ShowNames",
    Callback = function(Value)
        Settings.ESP.ShowNames = Value
    end,
})

local ShowDistance = VisualsTab:CreateToggle({
    Name = "Show Distance",
    CurrentValue = true,
    Flag = "ShowDistance",
    Callback = function(Value)
        Settings.ESP.ShowDistance = Value
    end,
})

local ShowHealth = VisualsTab:CreateToggle({
    Name = "Show Health",
    CurrentValue = true,
    Flag = "ShowHealth",
    Callback = function(Value)
        Settings.ESP.ShowHealth = Value
    end,
})

local ShowBoxes = VisualsTab:CreateToggle({
    Name = "Show Boxes",
    CurrentValue = true,
    Flag = "ShowBoxes",
    Callback = function(Value)
        Settings.ESP.ShowBoxes = Value
    end,
})

local ESPTeamCheck = VisualsTab:CreateToggle({
    Name = "Team Check",
    CurrentValue = true,
    Flag = "ESPTeamCheck",
    Callback = function(Value)
        Settings.ESP.TeamCheck = Value
    end,
})

local VisualSection = VisualsTab:CreateSection("World Visuals")

local RemoveFog = VisualsTab:CreateToggle({
    Name = "Remove Fog",
    CurrentValue = false,
    Flag = "RemoveFog",
    Callback = function(Value)
        Settings.Visual.RemoveFog = Value
        if Value then
            game.Lighting.FogEnd = 1000000
        else
            game.Lighting.FogEnd = 1000
        end
    end,
})

local Fullbright = VisualsTab:CreateToggle({
    Name = "Fullbright",
    CurrentValue = false,
    Flag = "Fullbright",
    Callback = function(Value)
        Settings.Visual.Fullbright = Value
    end,
})

-- Movement Tab
local MovementTab = Window:CreateTab("Movement", 4483362458)

local MovementSection = MovementTab:CreateSection("Movement Settings")

local SpeedToggle = MovementTab:CreateToggle({
    Name = "Enable Speed",
    CurrentValue = false,
    Flag = "SpeedToggle",
    Callback = function(Value)
        Settings.Movement.SpeedEnabled = Value
    end,
})

local SpeedSlider = MovementTab:CreateSlider({
    Name = "Walk Speed",
    Range = {16, 200},
    Increment = 1,
    CurrentValue = 16,
    Flag = "SpeedSlider",
    Callback = function(Value)
        Settings.Movement.Speed = Value
    end,
})

local JumpToggle = MovementTab:CreateToggle({
    Name = "Enable Jump Power",
    CurrentValue = false,
    Flag = "JumpToggle",
    Callback = function(Value)
        Settings.Movement.JumpEnabled = Value
    end,
})

local JumpSlider = MovementTab:CreateSlider({
    Name = "Jump Power",
    Range = {50, 200},
    Increment = 5,
    CurrentValue = 50,
    Flag = "JumpSlider",
    Callback = function(Value)
        Settings.Movement.JumpPower = Value
    end,
})

local NoClip = MovementTab:CreateToggle({
    Name = "No Clip",
    CurrentValue = false,
    Flag = "NoClip",
    Callback = function(Value)
        Settings.Movement.NoClip = Value
    end,
})

local InfiniteJump = MovementTab:CreateToggle({
    Name = "Infinite Jump",
    CurrentValue = false,
    Flag = "InfiniteJump",
    Callback = function(Value)
        Settings.Movement.InfiniteJump = Value
    end,
})

-- Misc Tab
local MiscTab = Window:CreateTab("Misc", 4483362458)

local MiscSection = MiscTab:CreateSection("Miscellaneous")

local RemoveKillBricks = MiscTab:CreateButton({
    Name = "Remove Kill Bricks",
    Callback = function()
        for _, v in pairs(Workspace:GetDescendants()) do
            if v:IsA("Part") and v.Name == "KillBrick" then
                v:Destroy()
            end
        end
        Rayfield:Notify({
            Title = "Success",
            Content = "Removed all kill bricks",
            Duration = 3,
            Image = 4483362458
        })
    end,
})

local UnlockGamepass = MiscTab:CreateButton({
    Name = "Unlock All Gamepasses (Visual)",
    Callback = function()
        Rayfield:Notify({
            Title = "Notice",
            Content = "This is client-sided only",
            Duration = 3,
            Image = 4483362458
        })
    end,
})

-- FOV Circle
local FOVCircle = Drawing.new("Circle")
FOVCircle.Thickness = 2
FOVCircle.NumSides = 50
FOVCircle.Radius = Settings.Aimbot.FOV
FOVCircle.Filled = false
FOVCircle.Visible = Settings.Aimbot.ShowFOV
FOVCircle.Color = Settings.Aimbot.FOVColor
FOVCircle.Transparency = 1
FOVCircle.Position = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)

-- ESP Functions
local function CreateESP(player)
    local esp = {
        Box = Drawing.new("Square"),
        Name = Drawing.new("Text"),
        Health = Drawing.new("Text"),
        Distance = Drawing.new("Text")
    }
    
    esp.Box.Visible = false
    esp.Box.Color = Settings.ESP.BoxColor
    esp.Box.Thickness = 2
    esp.Box.Transparency = 1
    esp.Box.Filled = false
    
    esp.Name.Visible = false
    esp.Name.Color = Settings.ESP.NameColor
    esp.Name.Center = true
    esp.Name.Outline = true
    esp.Name.Size = 14
    
    esp.Health.Visible = false
    esp.Health.Center = true
    esp.Health.Outline = true
    esp.Health.Size = 14
    
    esp.Distance.Visible = false
    esp.Distance.Center = true
    esp.Distance.Outline = true
    esp.Distance.Size = 14
    esp.Distance.Color = Color3.fromRGB(255, 255, 255)
    
    ESPObjects[player] = esp
end

local function UpdateESP()
    for player, esp in pairs(ESPObjects) do
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") and player.Character:FindFirstChild("Humanoid") then
            local hrp = player.Character.HumanoidRootPart
            local hum = player.Character.Humanoid
            
            if Settings.ESP.TeamCheck and player.Team == LocalPlayer.Team then
                esp.Box.Visible = false
                esp.Name.Visible = false
                esp.Health.Visible = false
                esp.Distance.Visible = false
            else
                local vector, onScreen = Camera:WorldToViewportPoint(hrp.Position)
                
                if onScreen and Settings.ESP.Enabled then
                    local head = Camera:WorldToViewportPoint(hrp.Position + Vector3.new(0, 2, 0))
                    local leg = Camera:WorldToViewportPoint(hrp.Position - Vector3.new(0, 3, 0))
                    
                    local height = math.abs(head.Y - leg.Y)
                    local width = height / 2
                    
                    if Settings.ESP.ShowBoxes then
                        esp.Box.Size = Vector2.new(width, height)
                        esp.Box.Position = Vector2.new(vector.X - width / 2, vector.Y - height / 2)
                        esp.Box.Visible = true
                    else
                        esp.Box.Visible = false
                    end
                    
                    if Settings.ESP.ShowNames then
                        esp.Name.Text = player.Name
                        esp.Name.Position = Vector2.new(vector.X, vector.Y - height / 2 - 20)
                        esp.Name.Visible = true
                    else
                        esp.Name.Visible = false
                    end
                    
                    if Settings.ESP.ShowHealth then
                        esp.Health.Text = "Health: " .. math.floor(hum.Health)
                        esp.Health.Position = Vector2.new(vector.X, vector.Y + height / 2 + 5)
                        esp.Health.Color = Color3.fromRGB(255 - (hum.Health / hum.MaxHealth) * 255, (hum.Health / hum.MaxHealth) * 255, 0)
                        esp.Health.Visible = true
                    else
                        esp.Health.Visible = false
                    end
                    
                    if Settings.ESP.ShowDistance then
                        local distance = math.floor((hrp.Position - LocalPlayer.Character.HumanoidRootPart.Position).Magnitude)
                        esp.Distance.Text = distance .. " studs"
                        esp.Distance.Position = Vector2.new(vector.X, vector.Y + height / 2 + 20)
                        esp.Distance.Visible = true
                    else
                        esp.Distance.Visible = false
                    end
                else
                    esp.Box.Visible = false
                    esp.Name.Visible = false
                    esp.Health.Visible = false
                    esp.Distance.Visible = false
                end
            end
        else
            esp.Box.Visible = false
            esp.Name.Visible = false
            esp.Health.Visible = false
            esp.Distance.Visible = false
        end
    end
end

-- Aimbot Functions
local function GetClosestPlayer()
    local closest = nil
    local shortestDistance = Settings.Aimbot.FOV
    
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("Head") and player.Character:FindFirstChild("Humanoid") and player.Character.Humanoid.Health > 0 then
            if Settings.Aimbot.TeamCheck and player.Team == LocalPlayer.Team then continue end
            
            local pos = Camera:WorldToViewportPoint(player.Character.Head.Position)
            local magnitude = (Vector2.new(pos.X, pos.Y) - Vector2.new(Mouse.X, Mouse.Y)).Magnitude
            
            if magnitude < shortestDistance then
                closest = player
                shortestDistance = magnitude
            end
        end
    end
    
    return closest
end

-- Movement & Combat Updates
RunService.RenderStepped:Connect(function()
    -- Update FOV Circle
    FOVCircle.Radius = Settings.Aimbot.FOV
    FOVCircle.Visible = Settings.Aimbot.ShowFOV
    FOVCircle.Position = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)
    
    -- Update ESP
    UpdateESP()
    
    -- Aimbot
    if Settings.Aimbot.Enabled and UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton2) then
        local target = GetClosestPlayer()
        if target then
            local aimPart = target.Character:FindFirstChild(Settings.Aimbot.AimPart)
            if aimPart then
                local targetPos = Camera:WorldToViewportPoint(aimPart.Position)
                local mousePos = Vector2.new(Mouse.X, Mouse.Y)
                local newPos = mousePos:Lerp(Vector2.new(targetPos.X, targetPos.Y), 1 / Settings.Aimbot.Smoothness)
                mousemoverel(newPos.X - mousePos.X, newPos.Y - mousePos.Y)
            end
        end
    end
    
    -- Movement
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
        if Settings.Movement.SpeedEnabled then
            LocalPlayer.Character.Humanoid.WalkSpeed = Settings.Movement.Speed
        end
        
        if Settings.Movement.JumpEnabled then
            LocalPlayer.Character.Humanoid.JumpPower = Settings.Movement.JumpPower
        end
    end
    
    -- NoClip
    if Settings.Movement.NoClip and LocalPlayer.Character then
        for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end
    
    -- Fullbright
    if Settings.Visual.Fullbright then
        game.Lighting.Brightness = 2
        game.Lighting.ClockTime = 14
        game.Lighting.GlobalShadows = false
        game.Lighting.OutdoorAmbient = Color3.fromRGB(128, 128, 128)
    end
end)

-- Player Added/Removing
Players.PlayerAdded:Connect(function(player)
    CreateESP(player)
end)

Players.PlayerRemoving:Connect(function(player)
    if ESPObjects[player] then
        for _, obj in pairs(ESPObjects[player]) do
            obj:Remove()
        end
        ESPObjects[player] = nil
    end
end)

-- Initialize ESP for existing players
for _, player in pairs(Players:GetPlayers()) do
    if player ~= LocalPlayer then
        CreateESP(player)
    end
end

-- Infinite Jump
UserInputService.JumpRequest:Connect(function()
    if Settings.Movement.InfiniteJump and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
        LocalPlayer.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
    end
end)

Rayfield:LoadConfiguration()
